
{
  "bream": {
    "version": "1.0.0",
    "species_key": "bream",
    "species_label": "Bream (all)",
    "units": {
      "temperature": "Â°C",
      "wind_speed": "kph",
      "pressure": "hPa",
      "precip_rate": "mm/h",
      "cloud_cover": "%",
      "humidity": "%",
      "uv_index": "index_0_11"
    },
    "inputs": {
      "air_temp_c": { "required": true },
      "water_temp_c": { "required": false, "nullable": true },
      "wind_speed_kph": { "required": true },
      "wind_dir_deg": { "required": false },
      "pressure_hpa": { "required": true },
      "pressure_trend_hpa_per_3h": { "required": true },
      "cloud_cover_pct": { "required": true },
      "precip_mm_per_h": { "required": true },
      "precip_probability_pct": { "required": false },
      "humidity_pct": { "required": false },
      "uv_index": { "required": false },
      "shortwave_radiation_wm2": { "required": false },
      "sunrise_ts": { "required": true },
      "sunset_ts": { "required": true },
      "time_ts": { "required": true },
      "moon_phase_0_new_05_full": { "required": false },
      "recent_air_temp_std_c_72h": { "required": false },
      "recent_pressure_std_hpa_72h": { "required": false },
      "water_level_change_m_24h": { "required": false, "nullable": true }
    },
    "derived": {
      "water_temp_c_estimated": {
        "source": "estimate_if_missing",
        "method": "ema_blend",
        "params": {
          "span_long_h": 72,
          "span_short_h": 12,
          "weights": [0.8, 0.2]
        },
        "uses": ["air_temp_c"]
      },
      "solar_elevation_deg": {
        "source": "astro",
        "uses": ["time_ts", "sunrise_ts", "sunset_ts"]
      },
      "effective_light_0_1": {
        "source": "formula",
        "formula": "clamp01(0.6*norm(solar_elevation_deg, min=-8, max=60) + 0.4*(1 - cloud_cover_pct/100))",
        "uses": ["solar_elevation_deg", "cloud_cover_pct"]
      },
      "stability_index": {
        "source": "formula",
        "formula": "combine_std(recent_air_temp_std_c_72h, recent_pressure_std_hpa_72h)",
        "uses": [
          "recent_air_temp_std_c_72h",
          "recent_pressure_std_hpa_72h"
        ]
      }
    },
    "weights": {
      "time_of_day": 0.18,
      "light_level": 0.12,
      "wind": 0.06,
      "pressure_trend": 0.12,
      "air_temp_comfort": 0.10,
      "water_temp_comfort": 0.16,
      "precip": 0.04,
      "moon": 0.08,
      "stability": 0.10,
      "level_flow": 0.04
    },
    "curves": {
      "time_of_day": {
        "type": "twilight_boost",
        "params": {
          "dawn_window_min": -60,
          "dawn_window_max": 90,
          "dawn_peak_offset_min": 20,
          "dusk_window_min": -90,
          "dusk_window_max": 60,
          "dusk_peak_offset_min": -20,
          "midday_penalty": 65,
          "night_penalty": 55
        },
        "uses": ["time_ts", "sunrise_ts", "sunset_ts"]
      },
      "light_level": {
        "type": "plateau",
        "params": {
          "preferred_ranges": [[0.25, 0.6]],
          "inside_score": 88,
          "outside_falloff": [
            { "to": 0, "score": 60 },
            { "to": 1, "score": 68 }
          ]
        },
        "uses": ["effective_light_0_1"]
      },
      "wind": {
        "type": "bucket_penalty",
        "params": {
          "breaks_kph": [0, 8, 18, 28],
          "scores": [82, 90, 65, 35]
        },
        "uses": ["wind_speed_kph"]
      },
      "pressure_trend": {
        "type": "piecewise_linear",
        "params": { "x": [-3, -1, 0, 1, 3], "y": [45, 62, 72, 86, 90] },
        "uses": ["pressure_trend_hpa_per_3h"]
      },
      "air_temp_comfort": {
        "type": "gaussian",
        "params": { "mu": 18, "sigma": 5, "max_score": 92 },
        "uses": ["air_temp_c"]
      },
      "water_temp_comfort": {
        "type": "gaussian",
        "params": { "mu": 16, "sigma": 3, "max_score": 100 },
        "uses": ["water_temp_c", "water_temp_c_estimated"],
        "fallback_chain": ["water_temp_c", "water_temp_c_estimated"]
      },
      "precip": {
        "type": "step",
        "params": {
          "mm_per_h": [0, 0.2, 1, 3],
          "scores": [80, 85, 68, 45]
        },
        "uses": ["precip_mm_per_h"]
      },
      "moon": {
        "type": "phase_bonus",
        "params": {
          "schema": "openmeteo_0_new_05_full",
          "bonuses": [
            { "phase": "new", "score": 85 },
            { "phase": "quarter", "score": 75 },
            { "phase": "full", "score": 80 }
          ]
        },
        "uses": ["moon_phase_0_new_05_full"]
      },
      "stability": {
        "type": "inverse_std",
        "params": { "std_breaks": [0.4, 1.5, 3], "scores": [92, 75, 55] },
        "uses": ["stability_index"]
      },
      "level_flow": {
        "type": "piecewise_linear",
        "params": {
          "x": [-0.3, -0.1, 0, 0.1, 0.3],
          "y": [55, 70, 78, 72, 58]
        },
        "uses": ["water_level_change_m_24h"],
        "missing_score": 75
      }
    },
    "combine": {
      "method": "weighted_sum",
      "normalize_weights": true,
      "clamp_to_0_100": true,
      "round": 0
    },
    "classification": {
      "bands": [
        { "label": "Poor", "min": 0, "max": 39 },
        { "label": "Fair", "min": 40, "max": 59 },
        { "label": "Good", "min": 60, "max": 79 },
        { "label": "Excellent", "min": 80, "max": 100 }
      ],
      "status_colors": {
        "Poor": "#EB5757",
        "Fair": "#F2C94C",
        "Good": "#27AE60",
        "Excellent": "#27AE60"
      }
    },
    "recommendation": {
      "series_smoothing": { "kernel": "moving_average", "window": 3 },
      "good_threshold": 60,
      "excellent_threshold": 80,
      "min_window_minutes": 45,
      "merge_gap_minutes": 60,
      "max_windows": 2
    },
    "explanations": {
      "max_positive_factors": 3,
      "max_negative_factors": 2,
      "positive_cutoff_score": 75,
      "negative_cutoff_score": 55,
      "labels": {
        "time_of_day": "Dawn/Dusk timing",
        "light_level": "Light level",
        "wind": "Wind",
        "pressure_trend": "Pressure trend",
        "air_temp_comfort": "Air temperature",
        "water_temp_comfort": "Water temperature",
        "precip": "Precipitation",
        "moon": "Moon phase",
        "stability": "Recent stability",
        "level_flow": "Water level change"
      }
    },
    "missing_data_policy": {
      "factor_default_score": 72,
      "use_fallback_chain": true,
      "drop_factor_if_missing_and_no_fallback": false
    },
    "bounds": { "min_score": 0, "max_score": 100 }
  },
  "bass": {
    "weights": { "timeOfDay":0.20, "cloud":0.12, "wind":0.08, "pressureTrend":0.15,
      "airTempComfort":0.10, "waterTempComfort":0.18, "precip":0.05, "moon":0.06, "stability":0.06, "levelFlow": 0.0 },
    "curves": {
      "waterTempComfort":{"type":"gauss","mu":20,"sigma":4},
      "airTempComfort":   {"type":"gauss","mu":22,"sigma":6},
      "cloud":{"type":"plateau","ranges":[[40,100]],"score":90},
      "pressureTrend":{"type":"trend","preFrontDropBonus":20,"riseBonus":5, "fallPenalty": 0},
      "timeOfDay":{"type":"twilightBoost","dawn":25,"dusk":20},
      "wind":{"type":"penalty","breaks":[12,25],"scores":[85,55,25]},
      "precip":           {"type":"step","mm":[0,0.2,1.5],"scores":[75,85,60]},
      "moon":             {"type":"phase","full":-5,"new":10,"q1q3":5},
      "stability":        {"type":"inverseVar","breaks":[0.8,2.5],"scores":[80,70,50]}
    }
  },
  "carp": {
    "weights": { "timeOfDay":0.18, "cloud":0.10, "wind":0.05, "pressureTrend":0.12,
      "airTempComfort":0.06, "waterTempComfort":0.22, "precip":0.05, "moon":0.08, "stability":0.09, "levelFlow":0.05 },
    "curves": {
      "waterTempComfort":{"type":"gauss","mu":22,"sigma":3},
      "airTempComfort":   {"type":"gauss","mu":24,"sigma":5},
      "stability":{"type":"inverseVar","breaks":[0.5,1.5],"scores":[92,75,45]},
      "wind":{"type":"penalty","breaks":[8,18],"scores":[90,65,35]},
      "cloud":{"type":"plateau","ranges":[[20,80]],"score":80},
      "pressureTrend":{"type":"trend","riseBonus":10,"fallPenalty":-5, "preFrontDropBonus": 5},
      "timeOfDay":        {"type":"twilightBoost","dawn":10,"dusk":15},
      "precip":           {"type":"step","mm":[0,0.5,3.0],"scores":[85,75,60]},
      "moon":             {"type":"phase","full":10,"new":5,"q1q3":-5}
    }
  }
}
